<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="How does AutoPWN Suite work?" /><meta property="og:locale" content="en" /><meta name="description" content="What is AutoPWN Suite?" /><meta property="og:description" content="What is AutoPWN Suite?" /><link rel="canonical" href="https://pwnspot.com/posts/AutoPWN/" /><meta property="og:url" content="https://pwnspot.com/posts/AutoPWN/" /><meta property="og:site_name" content="PWN SPOT!" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-03T12:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="How does AutoPWN Suite work?" /><meta name="twitter:site" content="@kaangultekin01" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-20T16:05:38+03:00","datePublished":"2022-06-03T12:00:00+03:00","description":"What is AutoPWN Suite?","headline":"How does AutoPWN Suite work?","mainEntityOfPage":{"@type":"WebPage","@id":"https://pwnspot.com/posts/AutoPWN/"},"url":"https://pwnspot.com/posts/AutoPWN/"}</script><title>How does AutoPWN Suite work? | PWN SPOT!</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="PWN SPOT!"><meta name="application-name" content="PWN SPOT!"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://github.com/GamehunterKaan/PWN-Spot/raw/main/assets/logo.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">PWN SPOT!</a></div><div class="site-subtitle font-italic">Welcome to PWN Spot, where the PWN is religion!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/GamehunterKaan" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/kaangultekin01" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kaangultekin01','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>How does AutoPWN Suite work?</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>How does AutoPWN Suite work?</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1654246800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 3, 2022 </em> </span> <span> Updated <em class="" data-ts="1658322338" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 20, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/GamehunterKaan">GamehunterKaan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2650 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><h1 id="what-is-autopwn-suite">What is AutoPWN Suite?</h1><p><a href="https://auto.pwnspot.com">AutoPWN Suite</a> is a project for scanning vulnerabilities and exploiting systems automatically.</p><h1 id="demo">Demo</h1><p>AutoPWN Suite has a very user friendly easy to read output.</p><script id="asciicast-509345" src="https://asciinema.org/a/509345.js" async=""></script><h1 id="how-does-it-work">How does it work?</h1><p>AutoPWN Suite uses nmap TCP-SYN scan to enumerate the host and detect the version of softwares running on it. After gathering enough information about the host, AutoPWN Suite automatically generates a list of “keywords” to search <a href="https://www.nist.gov/">NIST vulnerability database</a>.</p><h2 id="scanning"><span class="mr-2">Scanning</span><a href="#scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To create nmap scans in python we use <a href="https://bitbucket.org/xael/python-nmap/src/master/">nmap module</a> for python.</p><h2 id="host-discovery"><span class="mr-2">Host Discovery</span><a href="#host-discovery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To start doing host discovery, we first have to figure out which scan type we should use. Here’s how it’s done:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">InitArgsScanType</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
    <span class="n">scantype</span> <span class="o">=</span> <span class="n">ScanType</span><span class="p">.</span><span class="n">Ping</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">scan_type</span> <span class="o">==</span> <span class="s">"arp"</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_root</span><span class="p">():</span>
            <span class="n">scantype</span> <span class="o">=</span> <span class="n">ScanType</span><span class="p">.</span><span class="n">ARP</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span>
                <span class="s">"warning"</span><span class="p">,</span>
                <span class="s">"You need to be root in order to run arp scan.</span><span class="se">\n</span><span class="s">"</span>
                <span class="o">+</span> <span class="s">"Changed scan mode to Ping Scan."</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">scan_type</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">scan_type</span> <span class="o">==</span> <span class="s">""</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_root</span><span class="p">():</span>
            <span class="n">scantype</span> <span class="o">=</span> <span class="n">ScanType</span><span class="p">.</span><span class="n">ARP</span>

    <span class="k">return</span> <span class="n">scantype</span>
</pre></table></code></div></div><p>We now know which scan type to use for host discovery. Let’s also get our target to scan.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">InitArgsTarget</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">target</span><span class="p">:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">target</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">host_file</span><span class="p">:</span>
            <span class="c1"># read targets from host file and insert all of them into an array
</span>            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">host_file</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">target_file</span><span class="p">:</span>
                    <span class="n">target</span> <span class="o">=</span> <span class="n">target_file</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">splitlines</span><span class="p">()</span>
            <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
                <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"error"</span><span class="p">,</span> <span class="s">"Host file not found!"</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">PermissionError</span><span class="p">:</span>
                <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"error"</span><span class="p">,</span> <span class="s">"Permission denied while trying to read host file!"</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
                <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"error"</span><span class="p">,</span> <span class="s">"Unknown error while trying to read host file!"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">target</span>

            <span class="n">target</span> <span class="o">=</span> <span class="n">DetectIPRange</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">DontAskForConfirmation</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">target</span> <span class="o">=</span> <span class="n">DetectIPRange</span><span class="p">()</span>
                <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"error"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="n">target</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter target range to scan : "</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">target</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter target range to scan : "</span><span class="p">)</span>
                <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="nb">SystemExit</span><span class="p">(</span><span class="s">"Ctrl+C pressed. Exiting."</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">target</span>

</pre></table></code></div></div><p>Here’s how we detect target IP address range automatically:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">GetIpAdress</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_DGRAM</span><span class="p">)</span>
    <span class="n">s</span><span class="p">.</span><span class="n">connect</span><span class="p">((</span><span class="s">"8.8.8.8"</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
    <span class="n">PrivateIPAdress</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">getsockname</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">PrivateIPAdress</span>


<span class="k">def</span> <span class="nf">DetectIPRange</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">PrivateIPAdress</span> <span class="o">=</span> <span class="n">GetIpAdress</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"."</span><span class="p">)</span>
    <span class="n">target</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">PrivateIPAdress</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s">."</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">PrivateIPAdress</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s">."</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">PrivateIPAdress</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s">.0/24"</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">target</span>
</pre></table></code></div></div><p>Now we know our target and scan type we are going to use. So let’s get to scanning!</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">DiscoverHosts</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">console</span><span class="p">,</span> <span class="n">scantype</span><span class="o">=</span><span class="n">ScanType</span><span class="p">.</span><span class="n">ARP</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">ScanMode</span><span class="p">.</span><span class="n">Normal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">banner</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"Scanning </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="si">}</span><span class="s"> target(s) using </span><span class="si">{</span><span class="n">scantype</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> scan ..."</span><span class="p">,</span>
            <span class="s">"green"</span><span class="p">,</span>
            <span class="n">console</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s">"Scanning </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s"> using </span><span class="si">{</span><span class="n">scantype</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> scan ..."</span><span class="p">,</span> <span class="s">"green"</span><span class="p">,</span> <span class="n">console</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">scantype</span> <span class="o">==</span> <span class="n">ScanType</span><span class="p">.</span><span class="n">ARP</span><span class="p">:</span>
        <span class="n">OnlineHosts</span> <span class="o">=</span> <span class="n">TestArp</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">OnlineHosts</span> <span class="o">=</span> <span class="n">TestPing</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">OnlineHosts</span>
</pre></table></code></div></div><p>Online hosts in our network is returned from the function.</p><h2 id="port-scanning"><span class="mr-2">Port Scanning</span><a href="#port-scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In the previous part we ran a scan in our network to detect hosts that are online. But that information on it’s own is not enough. We need to detect the version of softwares running on the target machine. In order to do that, we scan the target machine for open ports.</p><p>It’s actually pretty straight forward.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">PortScan</span><span class="p">(</span>
    <span class="n">target</span><span class="p">,</span>
    <span class="n">log</span><span class="p">,</span>
    <span class="n">scanspeed</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">host_timeout</span><span class="o">=</span><span class="mi">240</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="n">ScanMode</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span>
    <span class="n">customflags</span><span class="o">=</span><span class="s">""</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PortScanner</span><span class="p">:</span>

    <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"info"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Scanning </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s"> for open ports ..."</span><span class="p">)</span>

    <span class="n">nm</span> <span class="o">=</span> <span class="n">PortScanner</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_root</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">ScanMode</span><span class="p">.</span><span class="n">Evade</span><span class="p">:</span>
                <span class="n">nm</span><span class="p">.</span><span class="n">scan</span><span class="p">(</span>
                    <span class="n">hosts</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                    <span class="n">arguments</span><span class="o">=</span><span class="s">" "</span><span class="p">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="s">"-sS"</span><span class="p">,</span>
                            <span class="s">"-sV"</span><span class="p">,</span>
                            <span class="s">"-O"</span><span class="p">,</span>
                            <span class="s">"-Pn"</span><span class="p">,</span>
                            <span class="s">"-T"</span><span class="p">,</span>
                            <span class="s">"2"</span><span class="p">,</span>
                            <span class="s">"-f"</span><span class="p">,</span>
                            <span class="s">"-g"</span><span class="p">,</span>
                            <span class="s">"53"</span><span class="p">,</span>
                            <span class="s">"--data-length"</span><span class="p">,</span>
                            <span class="s">"10"</span><span class="p">,</span>
                            <span class="n">customflags</span><span class="p">,</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nm</span><span class="p">.</span><span class="n">scan</span><span class="p">(</span>
                    <span class="n">hosts</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                    <span class="n">arguments</span><span class="o">=</span><span class="s">" "</span><span class="p">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="s">"-sS"</span><span class="p">,</span>
                            <span class="s">"-sV"</span><span class="p">,</span>
                            <span class="s">"--host-timeout"</span><span class="p">,</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">host_timeout</span><span class="p">),</span>
                            <span class="s">"-Pn"</span><span class="p">,</span>
                            <span class="s">"-O"</span><span class="p">,</span>
                            <span class="s">"-T"</span><span class="p">,</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">scanspeed</span><span class="p">),</span>
                            <span class="n">customflags</span><span class="p">,</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nm</span><span class="p">.</span><span class="n">scan</span><span class="p">(</span>
                <span class="n">hosts</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
                <span class="n">arguments</span><span class="o">=</span><span class="s">" "</span><span class="p">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s">"-sV"</span><span class="p">,</span>
                        <span class="s">"--host-timeout"</span><span class="p">,</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">host_timeout</span><span class="p">),</span>
                        <span class="s">"-Pn"</span><span class="p">,</span>
                        <span class="s">"-T"</span><span class="p">,</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">scanspeed</span><span class="p">),</span>
                        <span class="n">customflags</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">),</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">SystemExit</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nm</span>
</pre></table></code></div></div><h2 id="analyzing-the-results"><span class="mr-2">Analyzing the Results</span><a href="#analyzing-the-results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We ran a port scan on the host, but we didn’t print any information on the screen yet. We are going to use a custom function to analyze results and print them on to screen.</p><p>As I documented in the code snippet, we returned a <code class="language-plaintext highlighter-rouge">PortScanner</code> object as results, let’s analyze it.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">AnalyseScanResults</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">console</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="s">"""
    Analyse and print scan results.
    """</span>
    <span class="n">HostArray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">nm</span><span class="p">.</span><span class="n">all_hosts</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">nm</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
    <span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"warning"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Target </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s"> seems to be offline."</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">CurrentTargetInfo</span> <span class="o">=</span> <span class="n">InitHostInfo</span><span class="p">(</span><span class="n">nm</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">is_root</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">nm</span><span class="p">[</span><span class="n">target</span><span class="p">][</span><span class="s">"status"</span><span class="p">][</span><span class="s">"reason"</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">"localhost-response"</span><span class="p">,</span> <span class="s">"user-set"</span><span class="p">]:</span>
            <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"info"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Target </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s"> seems to be us."</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">GetIpAdress</span><span class="p">()</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"info"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Target </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s"> seems to be us."</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nm</span><span class="p">[</span><span class="n">target</span><span class="p">].</span><span class="n">all_tcp</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"warning"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Target </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s"> seems to have no open ports."</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HostArray</span>

    <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s">"Portscan results for </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="s">"green"</span><span class="p">,</span> <span class="n">console</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">CurrentTargetInfo</span><span class="p">.</span><span class="n">mac</span> <span class="o">==</span> <span class="s">"Unknown"</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">CurrentTargetInfo</span><span class="p">.</span><span class="n">os</span> <span class="o">==</span> <span class="s">"Unknown"</span><span class="p">:</span>
        <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="n">CurrentTargetInfo</span><span class="p">.</span><span class="n">colored</span><span class="p">(),</span> <span class="n">justify</span><span class="o">=</span><span class="s">"center"</span><span class="p">)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="p">.</span><span class="n">MINIMAL</span><span class="p">)</span>

    <span class="n">table</span><span class="p">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">"Port"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"cyan"</span><span class="p">)</span>
    <span class="n">table</span><span class="p">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">"State"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"white"</span><span class="p">)</span>
    <span class="n">table</span><span class="p">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">"Service"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"blue"</span><span class="p">)</span>
    <span class="n">table</span><span class="p">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">"Product"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"red"</span><span class="p">)</span>
    <span class="n">table</span><span class="p">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">"Version"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"purple"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">nm</span><span class="p">[</span><span class="n">target</span><span class="p">][</span><span class="s">"tcp"</span><span class="p">].</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="n">InitPortInfo</span><span class="p">(</span><span class="n">nm</span><span class="p">[</span><span class="n">target</span><span class="p">][</span><span class="s">"tcp"</span><span class="p">][</span><span class="n">port</span><span class="p">])</span>
        <span class="n">table</span><span class="p">.</span><span class="n">add_row</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">),</span> <span class="n">state</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s">"open"</span><span class="p">:</span>
            <span class="n">HostArray</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HostArray</span><span class="p">),</span> <span class="p">[</span><span class="n">target</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">version</span><span class="p">])</span>

    <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s">"center"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">HostArray</span>
</pre></table></code></div></div><h2 id="vulnerability-detection"><span class="mr-2">Vulnerability detection</span><a href="#vulnerability-detection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We scanned our host and now we now its open ports and some additional information on those ports.</p><p>Now this part is where I consider to be the actual magic. This part is essentially what makes vulnerability detection work.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">GenerateKeyword</span><span class="p">(</span><span class="n">product</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s">"Unknown"</span><span class="p">:</span>
        <span class="n">product</span> <span class="o">=</span> <span class="s">""</span>

    <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s">"Unknown"</span><span class="p">:</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s">""</span>

    <span class="n">keyword</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">dontsearch</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"ssh"</span><span class="p">,</span>
        <span class="s">"vnc"</span><span class="p">,</span>
        <span class="s">"http"</span><span class="p">,</span>
        <span class="s">"https"</span><span class="p">,</span>
        <span class="s">"ftp"</span><span class="p">,</span>
        <span class="s">"sftp"</span><span class="p">,</span>
        <span class="s">"smtp"</span><span class="p">,</span>
        <span class="s">"smb"</span><span class="p">,</span>
        <span class="s">"smbv2"</span><span class="p">,</span>
        <span class="s">"linux telnetd"</span><span class="p">,</span>
        <span class="s">"microsoft windows rpc"</span><span class="p">,</span>
        <span class="s">"metasploitable root shell"</span><span class="p">,</span>
        <span class="s">"gnu classpath grmiregistry"</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">product</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dontsearch</span> <span class="ow">and</span> <span class="n">product</span> <span class="o">!=</span> <span class="s">""</span><span class="p">:</span>
        <span class="n">keyword</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s">"</span><span class="p">.</span><span class="n">rstrip</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">keyword</span>


<span class="k">def</span> <span class="nf">GenerateKeywords</span><span class="p">(</span><span class="n">HostArray</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="n">keywords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">HostArray</span><span class="p">:</span>
        <span class="n">product</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">version</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

        <span class="n">keyword</span> <span class="o">=</span> <span class="n">GenerateKeyword</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">keyword</span> <span class="o">==</span> <span class="s">""</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>
            <span class="n">keywords</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">keywords</span>
</pre></table></code></div></div><p>We generated our list of keywords, now it’s time to turn them into search queries and throw them at the <a href="https://www.nist.gov/">NIST vulnerability database</a> as a POST request then see what we get.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">SearchSploits</span><span class="p">(</span><span class="n">HostArray</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">console</span><span class="p">,</span> <span class="n">console2</span><span class="p">,</span> <span class="n">apiKey</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="n">VulnsArray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">target</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">HostArray</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">term_width</span> <span class="o">=</span> <span class="n">get_terminal_width</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">CheckConnection</span><span class="p">(</span><span class="n">log</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">keywords</span> <span class="o">=</span> <span class="n">GenerateKeywords</span><span class="p">(</span><span class="n">HostArray</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"warning"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Insufficient information for </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span>
        <span class="s">"info"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Searching vulnerability database for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span><span class="si">}</span><span class="s"> keyword(s) ..."</span>
    <span class="p">)</span>

    <span class="n">printed_banner</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">with</span> <span class="n">console2</span><span class="p">.</span><span class="n">status</span><span class="p">(</span>
        <span class="s">"[white]Searching vulnerabilities ...[/white]"</span><span class="p">,</span> <span class="n">spinner</span><span class="o">=</span><span class="s">"bouncingBar"</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">status</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>
            <span class="n">status</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">status</span><span class="p">.</span><span class="n">update</span><span class="p">(</span>
                <span class="s">"[white]Searching vulnerability database for[/white] "</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s">"[red]</span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="s">[/red] [white]...[/white]"</span>
            <span class="p">)</span>
            <span class="n">ApiResponseCVE</span> <span class="o">=</span> <span class="n">SearchKeyword</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">apiKey</span><span class="p">)</span>
            <span class="n">status</span><span class="p">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ApiResponseCVE</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">printed_banner</span><span class="p">:</span>
                <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s">"Possible vulnerabilities for </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="s">"red"</span><span class="p">,</span> <span class="n">console</span><span class="p">)</span>
                <span class="n">printed_banner</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"┌─ [yellow][ </span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="s"> ][/yellow]"</span><span class="p">)</span>

            <span class="n">CVEs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">CVE</span> <span class="ow">in</span> <span class="n">ApiResponseCVE</span><span class="p">:</span>
                <span class="n">CVEs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">CVE</span><span class="p">.</span><span class="n">CVEID</span><span class="p">)</span>
                <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"│</span><span class="se">\n</span><span class="s">├─────┤ [red]</span><span class="si">{</span><span class="n">CVE</span><span class="p">.</span><span class="n">CVEID</span><span class="si">}</span><span class="s">[/red]</span><span class="se">\n</span><span class="s">│"</span><span class="p">)</span>

                <span class="n">wrapped_description</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">CVE</span><span class="p">.</span><span class="n">description</span><span class="p">,</span> <span class="n">term_width</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s">[cyan]Description: [/cyan]"</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">wrapped_description</span><span class="p">:</span>
                    <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"│</span><span class="se">\t\t\t</span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s">[cyan]Severity: [/cyan]</span><span class="si">{</span><span class="n">CVE</span><span class="p">.</span><span class="n">severity</span><span class="si">}</span><span class="s"> - </span><span class="si">{</span><span class="n">CVE</span><span class="p">.</span><span class="n">severity_score</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s">[cyan]Exploitability: [/cyan] </span><span class="si">{</span><span class="n">CVE</span><span class="p">.</span><span class="n">exploitability</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s">[cyan]Details: [/cyan] </span><span class="si">{</span><span class="n">CVE</span><span class="p">.</span><span class="n">details_url</span><span class="si">}</span><span class="s">"</span>
                <span class="p">)</span>

            <span class="n">VulnObject</span> <span class="o">=</span> <span class="n">VulnerableSoftware</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">keyword</span><span class="p">,</span> <span class="n">CVEs</span><span class="o">=</span><span class="n">CVEs</span><span class="p">)</span>
            <span class="n">VulnsArray</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">VulnObject</span><span class="p">)</span>
            <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="s">"└"</span> <span class="o">+</span> <span class="s">"─"</span> <span class="o">*</span> <span class="p">(</span><span class="n">term_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">VulnsArray</span>
</pre></table></code></div></div><h2 id="automatically-downloading-exploits"><span class="mr-2">Automatically downloading exploits</span><a href="#automatically-downloading-exploits" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We scanned our host and found some vulnerabilities. Now it’s time for exploitation! To exploit our target we will need to download “exploit codes”.</p><p>Here’s the structre of what an exploit code will look like in our program.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">ExploitInfo</span><span class="p">:</span>
    <span class="n">Platform</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">PublishDate</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">Type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">ExploitDBID</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">Author</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">Metasploit</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">Verified</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">Link</span><span class="p">:</span> <span class="nb">str</span>
</pre></table></code></div></div><h2 id="getting-our-exploits"><span class="mr-2">Getting our exploits</span><a href="#getting-our-exploits" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This part is pretty straight forward. Just passing every “vulnerability” object to our <code class="language-plaintext highlighter-rouge">GetExploitAsFile</code> function.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">GetExploitsFromArray</span><span class="p">(</span><span class="n">VulnsArray</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">console</span><span class="p">,</span> <span class="n">console2</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">target</span><span class="p">:</span>
        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s">"Downloading exploits for </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s">..."</span><span class="p">,</span> <span class="s">"blue"</span><span class="p">,</span> <span class="n">console</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s">"Downloading exploits..."</span><span class="p">,</span> <span class="s">"blue"</span><span class="p">,</span> <span class="n">console</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">console2</span><span class="p">.</span><span class="n">status</span><span class="p">(</span>
        <span class="s">"[red]Downloading exploits ...[/red]"</span><span class="p">,</span> <span class="n">spinner</span><span class="o">=</span><span class="s">"bouncingBar"</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">status</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">vulnerability</span> <span class="ow">in</span> <span class="n">VulnsArray</span><span class="p">:</span>
            <span class="n">status</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">status</span><span class="p">.</span><span class="n">update</span><span class="p">(</span>
                <span class="sa">f</span><span class="s">"[white]Downloading exploits for[/white] "</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s">"[red]</span><span class="si">{</span><span class="n">vulnerability</span><span class="p">.</span><span class="n">title</span><span class="si">}</span><span class="s">[/red] [white]...[/white]"</span>
            <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">GetExploitAsFile</span><span class="p">(</span><span class="n">vulnerability</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">console</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
                <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"warning"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Skipping exploits for </span><span class="si">{</span><span class="n">vulnerability</span><span class="p">.</span><span class="n">title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="getting-some-info-about-our-exploit"><span class="mr-2">Getting some info about our exploit</span><a href="#getting-some-info-about-our-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We will gather some information about our exploit to print it onto terminal.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">GetExploitAsFile</span><span class="p">(</span><span class="n">vulnerability</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">console</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">SoftwareName</span> <span class="o">=</span> <span class="n">vulnerability</span><span class="p">.</span><span class="n">title</span>
    <span class="n">CVEs</span> <span class="o">=</span> <span class="n">vulnerability</span><span class="p">.</span><span class="n">CVEs</span>
    <span class="n">term_width</span> <span class="o">=</span> <span class="n">get_terminal_width</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="s">"exploits"</span><span class="p">):</span>
        <span class="n">mkdir</span><span class="p">(</span><span class="s">"exploits"</span><span class="p">)</span>

    <span class="n">printed_software</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">CVE</span> <span class="ow">in</span> <span class="n">CVEs</span><span class="p">:</span>
        <span class="n">Exploits</span> <span class="o">=</span> <span class="n">GetExploitInfo</span><span class="p">(</span><span class="n">CVE</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Exploits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">status</span><span class="p">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">SoftwareName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">printed_software</span><span class="p">:</span>
            <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"┌─[yellow][ </span><span class="si">{</span><span class="n">SoftwareName</span><span class="si">}</span><span class="s"> ][/yellow]</span><span class="se">\n</span><span class="s">│"</span><span class="p">)</span>
            <span class="n">printed_software</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">SoftwareName</span><span class="p">)</span>

        <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"│</span><span class="se">\n</span><span class="s">├─────┤ [red]</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">CVE</span><span class="p">)</span><span class="si">}</span><span class="s">[/red]</span><span class="se">\n</span><span class="s">│"</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">exploit</span> <span class="ow">in</span> <span class="n">Exploits</span><span class="p">:</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">GetExploitContents</span><span class="p">(</span><span class="n">exploit</span><span class="p">.</span><span class="n">Link</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s">"exploits/</span><span class="si">{</span><span class="n">SoftwareName</span><span class="si">}</span><span class="s">"</span><span class="p">):</span>
                <span class="n">mkdir</span><span class="p">(</span><span class="sa">f</span><span class="s">"exploits/</span><span class="si">{</span><span class="n">SoftwareName</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s">"exploits/</span><span class="si">{</span><span class="n">SoftwareName</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">CVE</span><span class="si">}</span><span class="s">"</span><span class="p">):</span>
                <span class="n">mkdir</span><span class="p">(</span><span class="sa">f</span><span class="s">"exploits/</span><span class="si">{</span><span class="n">SoftwareName</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">CVE</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s">"exploits/</span><span class="si">{</span><span class="n">SoftwareName</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">CVE</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="s">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">exploitfile</span><span class="p">:</span>
                <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s">"├──────────# [white]exploits/</span><span class="si">{</span><span class="n">SoftwareName</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">CVE</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">[/white]</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s"> [cyan]Platform: [/cyan] </span><span class="si">{</span><span class="n">exploit</span><span class="p">.</span><span class="n">Platform</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s"> [cyan]Type: [/cyan] </span><span class="si">{</span><span class="n">exploit</span><span class="p">.</span><span class="n">Type</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s"> [cyan]Author: [/cyan] </span><span class="si">{</span><span class="n">exploit</span><span class="p">.</span><span class="n">Author</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s"> [cyan]Date: [/cyan] [bright_cyan]</span><span class="si">{</span><span class="n">exploit</span><span class="p">.</span><span class="n">PublishDate</span><span class="si">}</span><span class="s">[/bright_cyan]</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s"> [cyan]Metasploit: [/cyan] </span><span class="si">{</span><span class="n">exploit</span><span class="p">.</span><span class="n">Metasploit</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s"> [cyan]Verified: [/cyan]</span><span class="si">{</span><span class="n">exploit</span><span class="p">.</span><span class="n">Verified</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s">"│</span><span class="se">\t\t</span><span class="s"> [cyan]Link: [/cyan] </span><span class="si">{</span><span class="n">exploit</span><span class="p">.</span><span class="n">Link</span><span class="si">}</span><span class="se">\n</span><span class="s">│"</span>
                <span class="p">)</span>
                <span class="n">exploitfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">SoftwareName</span> <span class="ow">in</span> <span class="n">printed_software</span><span class="p">:</span>
        <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="s">"└"</span> <span class="o">+</span> <span class="s">"─"</span> <span class="o">*</span> <span class="p">(</span><span class="n">term_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><h1 id="noise-mode">Noise mode</h1><p>This mode is for generating a lot of suspicious activity in the network to cause a lot of false positives in IDS/IPS and network logs.</p><h2 id="creating-noisy-processes"><span class="mr-2">Creating noisy processes</span><a href="#creating-noisy-processes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This part we use multi threading module that is built into python to create separate processes for each host.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">NoiseScan</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">console</span><span class="p">,</span> <span class="n">scantype</span><span class="o">=</span><span class="n">ScanType</span><span class="p">.</span><span class="n">ARP</span><span class="p">,</span> <span class="n">noisetimeout</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">banner</span><span class="p">(</span><span class="s">"Creating noise..."</span><span class="p">,</span> <span class="s">"green"</span><span class="p">,</span> <span class="n">console</span><span class="p">)</span>

    <span class="n">Uphosts</span> <span class="o">=</span> <span class="n">TestPing</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scantype</span> <span class="o">==</span> <span class="n">ScanType</span><span class="p">.</span><span class="n">ARP</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_root</span><span class="p">():</span>
            <span class="n">Uphosts</span> <span class="o">=</span> <span class="n">TestArp</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">console</span><span class="p">.</span><span class="n">status</span><span class="p">(</span><span class="s">"Creating noise ..."</span><span class="p">,</span> <span class="n">spinner</span><span class="o">=</span><span class="s">"line"</span><span class="p">):</span>
            <span class="n">NoisyProcesses</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">Uphosts</span><span class="p">:</span>
                <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"info"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Started creating noise on </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s">..."</span><span class="p">)</span>
                <span class="n">P</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">CreateNoise</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">host</span><span class="p">,))</span>
                <span class="n">NoisyProcesses</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
                <span class="n">P</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">noisetimeout</span><span class="p">:</span>
                    <span class="n">sleep</span><span class="p">(</span><span class="n">noisetimeout</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"info"</span><span class="p">,</span> <span class="s">"Noise scan complete!"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">NoisyProcesses</span><span class="p">:</span>
            <span class="n">P</span><span class="p">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="k">raise</span> <span class="nb">SystemExit</span>
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="n">logger</span><span class="p">(</span><span class="s">"error"</span><span class="p">,</span> <span class="s">"Noise scan interrupted!"</span><span class="p">)</span>
        <span class="k">raise</span> <span class="nb">SystemExit</span>
</pre></table></code></div></div><h2 id="creating-the-noise"><span class="mr-2">Creating the noise</span><a href="#creating-the-noise" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This part is also pretty straight forward. We spawn a nmap process with speed set to 5.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">CreateNoise</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
    <span class="n">nm</span> <span class="o">=</span> <span class="n">PortScanner</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_root</span><span class="p">():</span>
                <span class="n">nm</span><span class="p">.</span><span class="n">scan</span><span class="p">(</span><span class="n">hosts</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="s">"-A -T 5 -D RND:10"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nm</span><span class="p">.</span><span class="n">scan</span><span class="p">(</span><span class="n">hosts</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="s">"-A -T 5"</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">SystemExit</span><span class="p">(</span><span class="s">"Ctr+C, aborting."</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
</pre></table></code></div></div><h1 id="installation">Installation</h1><p>You can install it using pip. (sudo recommended)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo pip install autopwn-suite
</pre></table></code></div></div><p>OR</p><p>You can clone the repo.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>git clone https://github.com/GamehunterKaan/AutoPWN-Suite.git
cd AutoPWN-Suite
sudo pip install -r requirements.txt
</pre></table></code></div></div><p>OR</p><p>You can download debian (deb) package from <a href="https://github.com/GamehunterKaan/AutoPWN-Suite/releases">releases.</a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>sudo pip install requests rich python-nmap bs4 distro
sudo apt-get install ./autopwn-suite_2.1.1.deb
</pre></table></code></div></div><p>OR</p><p>You can use Google Cloud Shell.</p><p><a href="https://shell.cloud.google.com/cloudshell/editor?cloudshell_git_repo=https://github.com/GamehunterKaan/AutoPWN-Suite.git"><img data-src="https://gstatic.com/cloudssh/images/open-btn.svg" alt="Open in Cloud Shell" data-proofer-ignore></a></p><h1 id="usage">Usage</h1><p>Running with root privileges (sudo) is always recommended.</p><p>Automatic mode</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">autopwn-suite -y
</span></pre></table></code></div></div><p>Help Menu</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>autopwn-suite <span class="nt">-h</span>
<span class="go">
usage: autopwn.py [-h] [-v] [-y] [-c CONFIG] [-nc] [-t TARGET] [-hf HOST_FILE] [-sd] [-st {arp,ping}] [-nf NMAP_FLAGS] [-s {0,1,2,3,4,5}] [-ht HOST_TIMEOUT] [-a API] [-m {evade,noise,normal}] [-nt TIMEOUT]
                  [-o OUTPUT] [-ot {html,txt,svg}] [-rp {email,webhook}] [-rpe EMAIL] [-rpep PASSWORD] [-rpet EMAIL] [-rpef EMAIL] [-rpes SERVER] [-rpesp PORT] [-rpw WEBHOOK]

AutoPWN Suite | A project for scanning vulnerabilities and exploiting systems automatically.

options:
  -h, --help            show this help message and exit
  -v, --version         Print version and exit.
  -y, --yes-please      Don't ask for anything. (Full automatic mode)
  -c CONFIG, --config CONFIG
                        Specify a config file to use. (Default : None)
  -nc, --no-color       Disable colors.

Scanning:
  Options for scanning

  -t TARGET, --target TARGET
                        Target range to scan. This argument overwrites the hostfile argument. (192.168.0.1 or 192.168.0.0/24)
  -hf HOST_FILE, --host-file HOST_FILE
                        File containing a list of hosts to scan.
  -sd, --skip-discovery
                        Skips the host discovery phase.
  -st {arp,ping}, --scan-type {arp,ping}
                        Scan type.
  -nf NMAP_FLAGS, --nmap-flags NMAP_FLAGS
                        Custom nmap flags to use for portscan. (Has to be specified like : -nf="-O")
  -s {0,1,2,3,4,5}, --speed {0,1,2,3,4,5}
                        Scan speed. (Default : 3)
  -ht HOST_TIMEOUT, --host-timeout HOST_TIMEOUT
                        Timeout for every host. (Default :240)
  -a API, --api API     Specify API key for vulnerability detection for faster scanning. (Default : None)
  -m {evade,noise,normal}, --mode {evade,noise,normal}
                        Scan mode.
  -nt TIMEOUT, --noise-timeout TIMEOUT
                        Noise mode timeout.

Reporting:
  Options for reporting

  -o OUTPUT, --output OUTPUT
                        Output file name. (Default : autopwn.log)
  -ot {html,txt,svg}, --output-type {html,txt,svg}
                        Output file type. (Default : html)
  -rp {email,webhook}, --report {email,webhook}
                        Report sending method.
  -rpe EMAIL, --report-email EMAIL
                        Email address to use for sending report.
  -rpep PASSWORD, --report-email-password PASSWORD
                        Password of the email report is going to be sent from.
  -rpet EMAIL, --report-email-to EMAIL
                        Email address to send report to.
  -rpef EMAIL, --report-email-from EMAIL
                        Email to send from.
  -rpes SERVER, --report-email-server SERVER
                        Email server to use for sending report.
  -rpesp PORT, --report-email-server-port PORT
                        Port of the email server.
  -rpw WEBHOOK, --report-webhook WEBHOOK
                        Webhook to use for sending report.
</span></pre></table></code></div></div><h1 id="module-usage">Module usage</h1><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">autopwn_suite.api</span> <span class="kn">import</span> <span class="n">AutoScanner</span>

<span class="n">scanner</span> <span class="o">=</span> <span class="n">AutoScanner</span><span class="p">()</span>
<span class="n">json_results</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="n">scan</span><span class="p">(</span><span class="s">"192.168.0.1"</span><span class="p">)</span>
<span class="n">scanner</span><span class="p">.</span><span class="n">save_to_file</span><span class="p">(</span><span class="s">"autopwn.json"</span><span class="p">)</span>
</pre></table></code></div></div><h1 id="todo">TODO</h1><p>Do you have a cool feature idea? <a href="https://github.com/GamehunterKaan/AutoPWN-Suite/issues/new?assignees=&amp;labels=&amp;template=feature_request.md&amp;title=">Create a feature request!</a></p><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />22 Completed.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Arch Linux package for Arch based systems like BlackArch and ArchAttack.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Function to brute force common services like <code class="language-plaintext highlighter-rouge">ssh</code>, <code class="language-plaintext highlighter-rouge">vnc</code>, <code class="language-plaintext highlighter-rouge">ftp</code>.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />GUI interface.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Daemon mode.</ul><h1 id="contributing-to-autopwn-suite">Contributing to AutoPWN Suite</h1><p>I would be glad if you are willing to contribute this project. I am looking forward to merge your pull request unless its something that is not needed or just a personal preference. Also minor changes and bug fixes will not be merged. Please create an issue for those and I will do it myself. <a href="https://github.com/GamehunterKaan/AutoPWN-Suite/blob/main/.github/CONTRIBUTING.md">Click here for more info!</a></p><h1 id="legal">Legal</h1><p>You may not rent or lease, distribute, modify, sell or transfer the software to a third party. AutoPWN Suite is free for distribution, and modification with the condition that credit is provided to the creator and not used for commercial use. You may not use software for illegal or nefarious purposes. No liability for consequential damages to the maximum extent permitted by all applicable laws.</p><h1 id="support-or-contact">Support or Contact</h1><p>Having trouble using this tool? You can reach me out on <a href="https://search.discordprofile.info/374953845438021635">discord</a>, <a href="https://github.com/GamehunterKaan/AutoPWN-Suite/issues/new/choose">create an issue</a> or <a href="https://github.com/GamehunterKaan/AutoPWN-Suite/discussions">create a discussion!</a></p><h1 id="support--hire-me">Support &amp; Hire Me!</h1><p>If you want to support my work and also get your job done you can hire me on <a href="https://www.fiverr.com/kaangultekin">Fiverr</a>! I do various things such as website pentesting, python programming, cleaning malware, PC optimization, file recovery and mentoring.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blog/'>blog</a>, <a href='/categories/programming/'>programming</a>, <a href='/categories/cyber-security/'>cyber security</a>, <a href='/categories/autopwn-suite/'>autopwn-suite</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/autopwn-suite/" class="post-tag no-text-decoration" >autopwn-suite</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=How+does+AutoPWN+Suite+work%3F+-+PWN+SPOT%21&url=https%3A%2F%2Fpwnspot.com%2Fposts%2FAutoPWN%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=How+does+AutoPWN+Suite+work%3F+-+PWN+SPOT%21&u=https%3A%2F%2Fpwnspot.com%2Fposts%2FAutoPWN%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fpwnspot.com%2Fposts%2FAutoPWN%2F&text=How+does+AutoPWN+Suite+work%3F+-+PWN+SPOT%21" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/AutoPWN/">How does AutoPWN Suite work?</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/autopwn-suite/">autopwn-suite</a> <a class="post-tag" href="/tags/helloworld/">helloworld</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HELLO/"><div class="card-body"> <em class="small" data-ts="1654139100" data-df="ll" > Jun 2, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hello World!</h3><div class="text-muted small"><p> Welcome to PWN Spot! Hello there kind stranger on the internet. I would like to first thank you for visiting my website! What is PWN Spot? PWN Spot is my personal website for cyber security and ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HELLO/" class="btn btn-outline-primary" prompt="Older"><p>Hello World!</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/GamehunterKaan">GamehunterKaan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/autopwn-suite/">autopwn-suite</a> <a class="post-tag" href="/tags/helloworld/">helloworld</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3"></p><button type="button" class="btn btn-primary" aria-label="Update"> </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
